<!DOCTYPE html>
<html>

<head>
<title>Programming for PWM generation using on-chip Timers</title>
<meta charset="ISO-8859-1">
<meta name="viewport" content="width=device-width, initial-scale=1">
<script type="text/javascript" src="lib/jquery.js"></script>
<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">	
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
<link rel="stylesheet" href="https://cdn.datatables.net/1.13.2/css/jquery.dataTables.min.css">
<link rel="stylesheet" href="css/buttonStyle.css">
<link rel="stylesheet" href="css/header.css">
<link rel="stylesheet" href="css/mainPage.css">
<link rel="stylesheet" href="css/style.css">
<link rel="stylesheet" href="css/transducer.css">
<link rel="stylesheet" href="css/toastr.min.css">
<style type="text/css">



</style>
</head>

<body bgproperties="fixed">

	<header>
		<img class="Coeplogo" src='images/COEPlogo.png' /> 
		<img class="VlabLogo" src='images/vlablogo.jpg' /> 
		<span id="colgName">COEP TECHNOLOGICAL UNIVERSITY, PUNE</span>
	</header>
	
	
	<div  class="row container-fluid" id="main-div1" style="margin : 5px 1px"">
	<div class="col-sm-9" id="buttonDiv">
	</div>
	<div class="col-sm-1" id="buttonDiv">
	<button type="button" class="btn btn-info button3"  id="refresh" data-toggle="modal"><i class="fa fa-refresh"></i> <b>REFRESH</b></button>
	</div>
	<div class="col-sm-2" id="buttonDiv">
	<button type="button" class="btn btn-danger button5" id="procedure" data-toggle="modal" data-target="#readProcedureModal"><b>READ PROCEDURE</b></button>
	</div>
	</div>
	<div class="row container-fluid" style="margin-top: 5px" id="mainDiv">

		<div class="col-lg-6" id="canvas">
			<div class="panel panel-primary">
				<div class="panel-heading " id="panelHeading2">
					<center id="centerText1">DIAGRAM</center>
				</div>
				<div class="panel-body" id="plot" hidden> 
<!-- 				<button id="start" onclick="start()">Start</button> -->
<!-- 				<button id="pause" onclick="pause()">Pause</button> -->
<!-- 				<button id="reset" onclick="reset()">Reset</button> -->
				</div>
				<div class="panel-body" id="canvas-div1">
				<img src="images/mainpageImg.png" style="width: 100%;height:100%"   class="img-fluid" ></img></div>
				<div class="panel-body" id="canvas-div">
				<div class="row">
				<div class="col-lg-12">
				
				</div>
				
				</div>
				
				</div>
				
			</div>
		</div>
		<div class="col-lg-6" id="main-div">
			<div class="panel panel-primary">
				<div class="panel-heading " id="panelHeading1">
					<center id="centerText2">BASIC KNOWLEDGE</center>
				</div>
				<div class="panel-body" id="main-div-conf">
<!-- 				code will be rendered here -->
				</div>
			</div>

		</div>
	</div>
	
<!-- Modal -->
<div class="modal fade" id="myModal" role="dialog">
	<div class="modal-dialog modal-md">
		<div class="modal-content">
			<div class="modal-header">			
				 <h4 class="modal-title" id="ModelTitle1">Message box</h4>
				 <button type="button" class="close" data-dismiss="modal" style="color:#fff;">&times;</button>
			</div>
			<div class="modal-body">
				<p id="modelMsg"></p>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-danger" id = "nextPage" data-dismiss="modal" >Okay</button>
			</div>
		</div>
	</div>
</div>	

<!-- procedure -->

<div id="readProcedureModal" class="modal fade" role="dialog">
  <div class="modal-dialog  modal-lg">

    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title"><center><b>PROCEDURE</b></center></h4>
      </div>
      <div class="modal-body">
    
<center id="modelTitle"><b>Configuration</b></center>
 <ol>
<li>Select Output Pin.</li>
<li>Select PWM Period value (mS).</li>
<li>Select Duty Cycle (10% - 100%).</li>
<li>Select LED Configuration.</li>
<li>Click on "GENERATE CODE" button to generate code.</li>
<li>Click on "COMPILE" button to compile code.</li>
<li>Click on "EXECUTE" button to execute code and goto mimic.</li>
<li>If you want to download code click on "DOWNLOAD" button.</li>
<li>The MIMIC will open on left side of screen.</li>
</ol>

<center id="modelTitle"><b>Mimic</b></center>
<ol>
<li>Click on selected output pin terminal(red circle) and click on anode terminal(red circle) for connection of the selected output pin to anode. OR click on anode terminal(red circle) and click on selected output pin terminal(red circle) for connect the anode to selected output pin.</li>
<li>Click on cathode terminal(red circle) and click on resistor terminal(red circle) for connection of cathode to resister. OR click on resistor terminal(red circle) and click on cathode terminal(red circle) for connection of resister to cathode.</li>
<li>Click on "Check Connection" button.</li>
<li>If you see alert like "Wrong Connection. Please Try Again." click on "Reset Connection" button and follow step 1,2 and 3.</li>
<li>If you see alert like "Connection Established Successfully. Now Click on Run Button." Click on "Run" button.</li>
<li>Output LED is on. now observe the square wave graph.</li>
<li>Click on "REFRESH" button. to Re-executing the experiment.</li>
</ol>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
      </div>
    </div>

  </div>
</div>



<script>	
	var clk_hex = "0x00";
	var state_p=0;
		var data = [{
	  x: [],
	  y: [],
	  mode: 'lines',
	  line: {
	    color: '#80CAF6'
	  }
	}];

var layout = {
  responsive: true,
  width: 670,
  height: 300,
  title: 'CCPR2 Timer',
  xaxis: {
    range: [0, 10],
    title: 'Time (mS)'
  },
  yaxis: {
    range: [-0.2, 6.4],
    title: 'Volatge (in V)'
  }
};

interval_plot = 0.01;
offTime = 0.02;
onTime = 0.03+offTime;

var time = 0;

var dt = 0.01;
var y = 1;
state_p=0;
  Plotly.newPlot('plot', data, layout);
  var interval_plot;
  function start(interval_plot1,offTime1,onTime1){
	 interval_plot = interval_plot1;
	  offTime = offTime1;
	  onTime = onTime1+offTime;
  time = 0; y = 0, dt = 0.01;
  data = [{
  x: [],
  y: [],
  mode: 'lines',
  line: {
    color: '#80CAF6'
  }
}];

var layout = {
  responsive: true,
  width: 670,
  height: 300,
  title: 'CCPR2 Timer',
  xaxis: {
    range: [0, 10],
    title: 'Time (mS)'
  },
  yaxis: {
    range: [-0.2, 6.4],
    title: 'Volatge (in V)'
  }
};
 
// var LedImg1=paper.image("images/offDiode.png", 285, 95, 0, 0);
// var  LedImg2=paper.image("images/onDiodePreview.png", 285, 95, 0, 0);
  Plotly.newPlot('plot', data, layout);
   interval_plot = setInterval(function() {
  time += dt;
//   console.log(time);
  if (time % (onTime) < (offTime)) {
    y = 0;
//     LedImg2.remove();
    LedImg1=paper.image("images/offDiode.png", 285, 95, 85, 85);
  } else {    
    y = 5;
//     LedImg1.remove();
    LedImg2=paper.image("images/onDiodefinalPreview.png", 285, 95, 85, 85);
//     Ledcircle.attr({ fill:'red'});
  }
  Plotly.extendTraces('plot', {x: [[time]], y: [[y]]}, [0]);
  if (time > 10) {
    Plotly.relayout('plot', {
      xaxis: {
        range: [time-10, time],
		title: 'Time (mS)'
      }
    });
  }
}, dt*100);
start_e =0;

}
	
  function reset() {
		clearInterval(time);
		clearInterval(interval_plot);
	    Plotly.deleteTraces('plot',0);	 
	      var time = 0;
	      state_p=1;
	      
	  } 
	function pause(){
	  clearInterval(interval_plot);
	}

</script>


	
	<footer> Copyrights &copy; COEP - Virtual Lab </footer>
</body>

<script type="text/javascript" src="lib/jquery.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.3/Chart.js"></script>
<script type="text/javascript" src="lib/raphael.js"></script>
<script type="text/javascript" src="lib/raphael.min.js"></script>
<scrip src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
<script type="text/javascript" src="https://code.jquery.com/jquery-3.5.1.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.5.3/jspdf.min.js"></script>
<script type="text/javascript" src="https://html2canvas.hertzen.com/dist/html2canvas.js"></script>
<script type="text/javascript" src="https://cdn.datatables.net/1.13.2/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
<script src="https://code.highcharts.com/highcharts.js"></script>
<script type="text/javascript" src="src/configuration.js"></script>
<!-- <script type="text/javascript" src="src/codeGenerate.js"></script> -->
<script type="text/javascript" src="src/mimic.js"></script>
<script type="text/javascript" src="src/toastr.min.js"></script>

<script>
    toastr.options = {
        'closeButton': true,
        'debug': false,
        'newestOnTop': false,
        'progressBar': false,
        'positionClass': 'toast-top-right',
        'preventDuplicates': false,
        'showDuration': '1000',
        'hideDuration': '1000',
        'timeOut': '500',
        'extendedTimeOut': '500',
        'showEasing': 'swing',
        'hideEasing': 'linear',
        'showMethod': 'fadeIn',
        'hideMethod': 'fadeOut',
    }
</script>
<script>
    document.getElementById('refresh').addEventListener('click', function() {
        location.reload();
    });
</script>
</html>